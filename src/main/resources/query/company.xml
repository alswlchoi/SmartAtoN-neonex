<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hankook.pg.content.company.dao.CompanyDao">
	<sql id="COMPANY_LIST">
		SELECT 
        	COMP_LICENSE,
        	COMP_CODE,
        	COMP_PHONE,
        	COMP_TEL,
        	COMP_REG_DT,
        	COMP_REG_USER
		FROM PG_COMPANY
	</sql>
    <select id="getMaxCompCode" resultType="String">
	     SELECT COMP_CODE FROM PG_COMPANY
			ORDER BY COMP_CODE DESC
			LIMIT 1
    </select>
    <select id="getCompanyList" parameterType="com.hankook.pg.content.company.dto.SearchCompanyDto" resultType="com.hankook.pg.content.company.dto.CompanyDto">
	     <include refid="COMPANY_LIST" />
			WHERE 1=1
			<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(compCode)">
	         	AND COMP_CODE LIKE CONCAT('%',#{compCode},'%')
	         </if> 
			ORDER BY COMP_CODE DESC
	   		LIMIT #{startRowNum} ,#{pageSize}
    </select>
    
    <select id="findCompanyCount" parameterType="com.hankook.pg.content.company.dto.SearchCompanyDto" resultType="Integer">
         SELECT COUNT(*)
         FROM PG_COMPANY WHERE 1=1
         <if test="@org.apache.commons.lang3.StringUtils@isNotBlank(compCode)">
         	AND COMP_CODE LIKE CONCAT('%',#{compCode},'%')
         </if> 
    </select>
    
 	<select id="countCompany" parameterType="com.hankook.pg.content.company.dto.CompanyDto" resultType="Integer">
        SELECT  COUNT(*) FROM PG_COMPANY
        WHERE COMP_CODE = #{compCode}
    </select>
    
    <select id="getCompCodeduplCheck" parameterType="String" resultType="Integer">
        SELECT COUNT(*) AS CNT
		FROM PG_COMPANY
		WHERE COMP_CODE=#{compCode}
    </select>
    
    <select id="getCompanyDetail" parameterType="String" resultType="com.hankook.pg.content.company.dto.CompanyDto">
         <include refid="COMPANY_LIST" />
		WHERE COMP_CODE=#{compCode }
    </select>    
    
    <insert id="insertCompany" parameterType="com.hankook.pg.content.company.dto.CompanyDto">
       INSERT INTO PG_COMPANY
		(COMP_LICENSE, COMP_CODE, COMP_PHONE, COMP_TEL, COMP_REG_DT, COMP_REG_USER)
		VALUES(#{compLicense}, #{compCode}, #{compPhone}, #{compTel}, #{compRegDt}, #{compRegUser})

    </insert>
    
    <update id="updateCompany" parameterType="com.hankook.pg.content.company.dto.CompanyDto">
        UPDATE PG_COMPANY SET
        	COMP_LICENSE=#{compLicense},
        	COMP_PHONE=#{compPhone},
        	COMP_TEL=#{compTel},
        	COMP_REG_USER=#{compRegUser}
		WHERE COMP_CODE=#{compCode}
    </update>
    
    <delete id = "deleteCompany" parameterType="com.hankook.pg.content.company.dto.CompanyDto">
        DELETE FROM PG_COMPANY
        WHERE COMP_CODE=#{compCode}
    </delete>
</mapper>